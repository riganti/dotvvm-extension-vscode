---
scopeName: source.dotvvm
fileTypes:
- dothtml
- dotmaster
- dotcontrol
- dotlayout
patterns:
- include: '#scope'
- include: text.html.basic

repository:
  scope:
    patterns:
    - include: '#directives'
    - include: '#comments'
    - include: '#literalBindings'

  comments:
    begin: '<%--'
    end: '--%>'
    name: comment.block.dotvvm.server

  directives:
    begin: '\A'
    end: '^(?=\s*[^@\s])' # first non-empty row not starting with @
    name: meta.dotvvm.directives
    patterns:
    - begin: '^(@)(\w+)\s*'
      beginCaptures:
        '1': { name: markup.bold.dotvvm.directive.at }
        '2': { name: keyword.control.dotvvm.directive.type }
      end: '\n'

  literalBindings:
    begin: '(\{\{)\s*([a-zA-Z0-9]*)\s*(:?)'
    beginCaptures:
      1: { name: markup.bold.dotvvm.binding.begin }
      2: { name: keyword.control.dotvvm.binding.type }
      3: { name: punctuation.dotvvm.binding.colon }
    end: '\}\}'
    endCaptures: { 0: { name: markup.bold.dotvvm.binding.end } }
    contentName: keyword.operator.dotvvm.binding
